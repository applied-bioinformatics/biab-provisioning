---

- name: copy src for build
  copy:
    src: src
    dest: /tmp/biab

- name: copy dockerfile for build
  copy:
    src: Dockerfile
    dest: /tmp/biab/Dockerfile

- name: copy docker compose template
  template:
    src: container.yml
    dest: /tmp/biab

- name: deploy biab web containers
  become: True
  command: docker-compose -f /tmp/biab/container.yml up -d
  register: dc
  changed_when: '"Creating biab_biab_1" in dc.stderr'

- name: clean up
  file:
    state: absent
    path: /tmp/biab
